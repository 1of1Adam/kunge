{
  "version": 3,
  "sources": ["../src/saveload/save-load-adapter.js", "../src/saveload/index.js"],
  "sourcesContent": ["/**\n * TradingView SaveLoadAdapter\n * \u5B9E\u73B0 IExternalSaveLoadAdapter \u63A5\u53E3\uFF0C\u8FDE\u63A5\u540E\u7AEF\u5B58\u50A8\u670D\u52A1\n */\n\n// P0-6: localStorage \u540C\u6B65\u914D\u7F6E\nconst SAVE_DEBOUNCE_MS = 1000; // \u9632\u6296\u5EF6\u8FDF 1 \u79D2\nconst STORAGE_KEY = 'SaveLoadAdapter_drawingSymbolMap';\n\nclass SaveLoadAdapter {\n  /**\n   * @param {string} baseUrl - \u540E\u7AEF\u670D\u52A1\u5730\u5740\n   * @param {Object} options - \u914D\u7F6E\u9009\u9879\n   * @param {number} options.timeout - \u8BF7\u6C42\u8D85\u65F6\u65F6\u95F4\uFF08\u6BEB\u79D2\uFF09\uFF0C\u9ED8\u8BA4 10000\n   * @param {number} options.maxRetries - \u6700\u5927\u91CD\u8BD5\u6B21\u6570\uFF0C\u9ED8\u8BA4 3\n   * @param {boolean} options.debug - \u662F\u5426\u542F\u7528\u8C03\u8BD5\u65E5\u5FD7\uFF0C\u9ED8\u8BA4 false\n   */\n  constructor(baseUrl = `http://${window.location.hostname}:3001`, options = {}) {\n    this.baseUrl = baseUrl.replace(/\\/$/, '');\n    this.timeout = options.timeout || 10000;\n    this.maxRetries = options.maxRetries || 3;\n    this.debug = options.debug || false;\n\n    // P0-6 \u4FEE\u590D: \u9632\u6296\u4FDD\u5B58\u5B9A\u65F6\u5668\n    this._saveDebounceTimer = null;\n    this._pendingSave = false;\n\n    // \u4ECE localStorage \u6062\u590D\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\uFF08\u89E3\u51B3\u5237\u65B0\u540E\u4E22\u5931\u95EE\u9898\uFF09\n    this._loadDrawingSymbolMap();\n\n    // \u6E05\u7406\u8FC7\u591A\u7684\u65E7\u6620\u5C04\u6570\u636E\uFF0C\u9632\u6B62 localStorage \u65E0\u9650\u589E\u957F\n    this._cleanupOldMappings();\n\n    // P0-6 \u4FEE\u590D: \u76D1\u542C storage \u4E8B\u4EF6\u5904\u7406\u8DE8\u6807\u7B7E\u9875\u66F4\u65B0\n    this._setupStorageListener();\n\n    this._log('\u521D\u59CB\u5316\u5B8C\u6210\uFF0C\u540E\u7AEF\u5730\u5740:', this.baseUrl);\n  }\n\n  /**\n   * \u6761\u4EF6\u65E5\u5FD7\u8F93\u51FA\n   */\n  _log(...args) {\n    if (this.debug) {\n      console.log('[SaveLoadAdapter]', ...args);\n    }\n  }\n\n  /**\n   * \u53D1\u9001 HTTP \u8BF7\u6C42\u7684\u901A\u7528\u65B9\u6CD5\uFF08\u652F\u6301\u8D85\u65F6\u548C\u91CD\u8BD5\uFF09\n   * @param {string} endpoint - API \u7AEF\u70B9\n   * @param {Object} options - fetch \u9009\u9879\n   * @param {number} retries - \u5269\u4F59\u91CD\u8BD5\u6B21\u6570\n   */\n  async _fetch(endpoint, options = {}, retries = this.maxRetries) {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), this.timeout);\n\n    try {\n      const response = await fetch(`${this.baseUrl}/api/storage${endpoint}`, {\n        headers: { 'Content-Type': 'application/json' },\n        ...options,\n        signal: controller.signal,\n      });\n      clearTimeout(timeoutId);\n\n      if (!response.ok) {\n        const error = await response.json().catch(() => ({ message: response.statusText }));\n        throw new Error(error.message || `HTTP ${response.status}`);\n      }\n\n      return response.json();\n    } catch (error) {\n      clearTimeout(timeoutId);\n\n      // \u7F51\u7EDC\u9519\u8BEF\u65F6\u91CD\u8BD5\uFF08\u8D85\u65F6\u5F02\u5E38\u4E0D\u91CD\u8BD5\uFF09\n      if (retries > 0 && error.name !== 'AbortError') {\n        this._log(`\u8BF7\u6C42\u5931\u8D25\uFF0C\u91CD\u8BD5\u4E2D... (${retries} \u6B21\u5269\u4F59)`);\n        await new Promise(r => setTimeout(r, 1000));\n        return this._fetch(endpoint, options, retries - 1);\n      }\n\n      console.error(`[SaveLoadAdapter] \u8BF7\u6C42\u5931\u8D25 ${endpoint}:`, error.message);\n      throw error;\n    }\n  }\n\n  // ==================== \u56FE\u8868\u5E03\u5C40 (Charts) ====================\n\n  /**\n   * \u83B7\u53D6\u6240\u6709\u56FE\u8868\u5217\u8868\n   * @returns {Promise<ChartMetaInfo[]>}\n   */\n  async getAllCharts() {\n    this._log('getAllCharts');\n    return this._fetch('/charts');\n  }\n\n  /**\n   * \u4FDD\u5B58\u56FE\u8868\n   * @param {ChartData} chartData\n   * @returns {Promise<string|number>} \u8FD4\u56DE\u56FE\u8868 ID\n   */\n  async saveChart(chartData) {\n    this._log('saveChart:', chartData.name);\n    const result = await this._fetch('/charts', {\n      method: 'POST',\n      body: JSON.stringify(chartData),\n    });\n    return result.id;\n  }\n\n  /**\n   * \u83B7\u53D6\u56FE\u8868\u5185\u5BB9\n   * @param {string|number} chartId\n   * @returns {Promise<string>}\n   */\n  async getChartContent(chartId) {\n    this._log('getChartContent:', chartId);\n    const result = await this._fetch(`/charts/${chartId}/content`);\n    return result.content;\n  }\n\n  /**\n   * \u5220\u9664\u56FE\u8868\n   * @param {string|number} chartId\n   * @returns {Promise<void>}\n   */\n  async removeChart(chartId) {\n    this._log('removeChart:', chartId);\n    await this._fetch(`/charts/${chartId}`, { method: 'DELETE' });\n  }\n\n  // ==================== \u6307\u6807\u6A21\u677F (Study Templates) ====================\n\n  /**\n   * \u83B7\u53D6\u6240\u6709\u6307\u6807\u6A21\u677F\n   * @returns {Promise<StudyTemplateMetaInfo[]>}\n   */\n  async getAllStudyTemplates() {\n    this._log('getAllStudyTemplates');\n    return this._fetch('/study-templates');\n  }\n\n  /**\n   * \u4FDD\u5B58\u6307\u6807\u6A21\u677F\n   * @param {StudyTemplateData} studyTemplateData\n   * @returns {Promise<void>}\n   */\n  async saveStudyTemplate(studyTemplateData) {\n    this._log('saveStudyTemplate:', studyTemplateData.name);\n    await this._fetch('/study-templates', {\n      method: 'POST',\n      body: JSON.stringify(studyTemplateData),\n    });\n  }\n\n  /**\n   * \u83B7\u53D6\u6307\u6807\u6A21\u677F\u5185\u5BB9\n   * @param {StudyTemplateMetaInfo} studyTemplateInfo\n   * @returns {Promise<string>}\n   */\n  async getStudyTemplateContent(studyTemplateInfo) {\n    this._log('getStudyTemplateContent:', studyTemplateInfo.name);\n    const result = await this._fetch(`/study-templates/${encodeURIComponent(studyTemplateInfo.name)}`);\n    return result.content;\n  }\n\n  /**\n   * \u5220\u9664\u6307\u6807\u6A21\u677F\n   * @param {StudyTemplateMetaInfo} studyTemplateInfo\n   * @returns {Promise<void>}\n   */\n  async removeStudyTemplate(studyTemplateInfo) {\n    this._log('removeStudyTemplate:', studyTemplateInfo.name);\n    await this._fetch(`/study-templates/${encodeURIComponent(studyTemplateInfo.name)}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // ==================== \u7ED8\u56FE\u6A21\u677F (Drawing Templates) ====================\n\n  /**\n   * \u83B7\u53D6\u67D0\u4E2A\u5DE5\u5177\u7684\u6240\u6709\u6A21\u677F\u540D\u79F0\n   * @param {string} toolName\n   * @returns {Promise<string[]>}\n   */\n  async getDrawingTemplates(toolName) {\n    this._log('getDrawingTemplates:', toolName);\n    const result = await this._fetch(`/drawing-templates/${encodeURIComponent(toolName)}`);\n    return result.templates || [];\n  }\n\n  /**\n   * \u4FDD\u5B58\u7ED8\u56FE\u6A21\u677F\n   * @param {string} toolName\n   * @param {string} templateName\n   * @param {string} content\n   * @returns {Promise<void>}\n   */\n  async saveDrawingTemplate(toolName, templateName, content) {\n    this._log('saveDrawingTemplate:', toolName, templateName);\n    await this._fetch(\n      `/drawing-templates/${encodeURIComponent(toolName)}/${encodeURIComponent(templateName)}`,\n      {\n        method: 'POST',\n        body: JSON.stringify({ content }),\n      }\n    );\n  }\n\n  /**\n   * \u52A0\u8F7D\u7ED8\u56FE\u6A21\u677F\n   * @param {string} toolName\n   * @param {string} templateName\n   * @returns {Promise<string>}\n   */\n  async loadDrawingTemplate(toolName, templateName) {\n    this._log('loadDrawingTemplate:', toolName, templateName);\n    const result = await this._fetch(\n      `/drawing-templates/${encodeURIComponent(toolName)}/${encodeURIComponent(templateName)}`\n    );\n    return result.content;\n  }\n\n  /**\n   * \u5220\u9664\u7ED8\u56FE\u6A21\u677F\n   * @param {string} toolName\n   * @param {string} templateName\n   * @returns {Promise<void>}\n   */\n  async removeDrawingTemplate(toolName, templateName) {\n    this._log('removeDrawingTemplate:', toolName, templateName);\n    await this._fetch(\n      `/drawing-templates/${encodeURIComponent(toolName)}/${encodeURIComponent(templateName)}`,\n      { method: 'DELETE' }\n    );\n  }\n\n  // ==================== \u56FE\u8868\u6A21\u677F (Chart Templates) ====================\n\n  /**\n   * \u83B7\u53D6\u6240\u6709\u56FE\u8868\u6A21\u677F\u540D\u79F0\n   * @returns {Promise<string[]>}\n   */\n  async getAllChartTemplates() {\n    this._log('getAllChartTemplates');\n    const result = await this._fetch('/chart-templates');\n    return result.templates || [];\n  }\n\n  /**\n   * \u4FDD\u5B58\u56FE\u8868\u6A21\u677F\n   * @param {string} templateName\n   * @param {ChartTemplateContent} theme\n   * @returns {Promise<void>}\n   */\n  async saveChartTemplate(templateName, theme) {\n    this._log('saveChartTemplate:', templateName);\n    await this._fetch('/chart-templates', {\n      method: 'POST',\n      body: JSON.stringify({ name: templateName, content: theme }),\n    });\n  }\n\n  /**\n   * \u83B7\u53D6\u56FE\u8868\u6A21\u677F\u5185\u5BB9\n   * @param {string} templateName\n   * @returns {Promise<ChartTemplate>}\n   */\n  async getChartTemplateContent(templateName) {\n    this._log('getChartTemplateContent:', templateName);\n    const result = await this._fetch(`/chart-templates/${encodeURIComponent(templateName)}`);\n    return { content: result.content };\n  }\n\n  /**\n   * \u5220\u9664\u56FE\u8868\u6A21\u677F\n   * @param {string} templateName\n   * @returns {Promise<void>}\n   */\n  async removeChartTemplate(templateName) {\n    this._log('removeChartTemplate:', templateName);\n    await this._fetch(`/chart-templates/${encodeURIComponent(templateName)}`, {\n      method: 'DELETE',\n    });\n  }\n\n  // ==================== \u6309\u7B26\u53F7\u4FDD\u5B58\u7ED8\u56FE (Symbol Drawings) ====================\n  // \u5B9E\u73B0 TradingView saveload_separate_drawings_storage \u529F\u80FD\n  // \u5B98\u65B9\u6587\u6863: https://www.tradingview.com/charting-library-docs/latest/saving_loading/saving_drawings_separately/\n\n  /**\n   * \u4FDD\u5B58\u7ED8\u56FE\u72B6\u6001\u5230\u540E\u7AEF\uFF08\u6309\u7B26\u53F7\u5206\u7EC4\uFF09\n   * \u5F53\u7528\u6237\u6DFB\u52A0\u3001\u4FEE\u6539\u6216\u5220\u9664\u56FE\u8868\u4E0A\u7684\u7ED8\u56FE\u65F6\uFF0CTradingView \u4F1A\u8C03\u7528\u6B64\u65B9\u6CD5\n   *\n   * @param {string} layoutId - \u56FE\u8868\u5E03\u5C40 ID\n   * @param {string|number} chartId - \u56FE\u8868 ID\n   * @param {LineToolsAndGroupsState} state - \u7ED8\u56FE\u72B6\u6001\u5BF9\u8C61\n   *   - state.sources: Map<string, LineToolState | null> - \u7ED8\u56FE key -> \u72B6\u6001\u7684\u6620\u5C04\uFF0Cnull \u8868\u793A\u5220\u9664\n   *   - state.groups: Map<string, string[] | null> - \u5206\u7EC4 key -> \u7ED8\u56FE key \u6570\u7EC4\u7684\u6620\u5C04\n   * @returns {Promise<void>}\n   */\n  async saveLineToolsAndGroups(layoutId, chartId, state) {\n    this._log('saveLineToolsAndGroups:', { layoutId, chartId });\n\n    const sources = state.sources;\n    const groups = state.groups;\n\n    // \u6309\u7B26\u53F7\u5206\u7EC4\u5904\u7406\u7ED8\u56FE\n    const symbolDrawingsMap = new Map(); // symbol -> [{ key, state }]\n    const symbolGroupsMap = new Map();   // symbol -> [{ key, drawingKeys }]\n\n    // \u5904\u7406\u7ED8\u56FE sources\n    if (sources && sources.size > 0) {\n      for (const [key, drawingState] of sources) {\n        const symbol = drawingState?.symbol;\n\n        if (!symbol && drawingState !== null) {\n          this._log(`\u8DF3\u8FC7\u65E0\u7B26\u53F7\u7684\u7ED8\u56FE: ${key}`);\n          continue;\n        }\n\n        // \u4F7F\u7528\u4E0A\u4E00\u6B21\u8BB0\u5F55\u7684\u7B26\u53F7\uFF08\u7528\u4E8E\u5220\u9664\u64CD\u4F5C\uFF09\n        const targetSymbol = symbol || this._getDrawingSymbol(layoutId, chartId, key);\n        if (!targetSymbol) continue;\n\n        if (!symbolDrawingsMap.has(targetSymbol)) {\n          symbolDrawingsMap.set(targetSymbol, []);\n        }\n\n        symbolDrawingsMap.get(targetSymbol).push({ key, state: drawingState });\n\n        // \u8BB0\u5F55\u7ED8\u56FE\u4E0E\u7B26\u53F7\u7684\u6620\u5C04\u5173\u7CFB\n        if (drawingState !== null) {\n          this._setDrawingSymbol(layoutId, chartId, key, symbol);\n        } else {\n          this._removeDrawingSymbol(layoutId, chartId, key);\n        }\n      }\n    }\n\n    // \u5904\u7406\u5206\u7EC4 groups\n    if (groups && groups.size > 0) {\n      for (const [groupKey, drawingKeys] of groups) {\n        // \u4ECE\u5206\u7EC4\u4E2D\u7684\u7B2C\u4E00\u4E2A\u7ED8\u56FE\u83B7\u53D6\u7B26\u53F7\n        let targetSymbol = null;\n        if (drawingKeys && drawingKeys.length > 0) {\n          targetSymbol = this._getDrawingSymbol(layoutId, chartId, drawingKeys[0]);\n        }\n\n        if (!targetSymbol) {\n          this._log(`\u8DF3\u8FC7\u65E0\u6CD5\u786E\u5B9A\u7B26\u53F7\u7684\u5206\u7EC4: ${groupKey}`);\n          continue;\n        }\n\n        if (!symbolGroupsMap.has(targetSymbol)) {\n          symbolGroupsMap.set(targetSymbol, []);\n        }\n\n        symbolGroupsMap.get(targetSymbol).push({\n          key: groupKey,\n          drawingKeys: drawingKeys, // null \u8868\u793A\u5220\u9664\n        });\n      }\n    }\n\n    // \u6279\u91CF\u4FDD\u5B58\u7ED8\u56FE\u548C\u5206\u7EC4\n    const promises = [];\n\n    // \u4FDD\u5B58\u7ED8\u56FE\n    for (const [symbol, drawings] of symbolDrawingsMap) {\n      this._log(`\u4FDD\u5B58\u7B26\u53F7 ${symbol} \u7684 ${drawings.length} \u4E2A\u7ED8\u56FE`);\n      promises.push(\n        this._fetch(`/drawings/${encodeURIComponent(symbol)}/batch`, {\n          method: 'POST',\n          body: JSON.stringify({ drawings }),\n        }).catch(err => {\n          console.error(`[SaveLoadAdapter] \u4FDD\u5B58\u7B26\u53F7 ${symbol} \u7ED8\u56FE\u5931\u8D25:`, err);\n        })\n      );\n    }\n\n    // \u4FDD\u5B58\u5206\u7EC4\n    for (const [symbol, groupsList] of symbolGroupsMap) {\n      this._log(`\u4FDD\u5B58\u7B26\u53F7 ${symbol} \u7684 ${groupsList.length} \u4E2A\u5206\u7EC4`);\n      promises.push(\n        this._fetch(`/drawings/${encodeURIComponent(symbol)}/groups/batch`, {\n          method: 'POST',\n          body: JSON.stringify({ groups: groupsList }),\n        }).catch(err => {\n          console.error(`[SaveLoadAdapter] \u4FDD\u5B58\u7B26\u53F7 ${symbol} \u5206\u7EC4\u5931\u8D25:`, err);\n        })\n      );\n    }\n\n    await Promise.all(promises);\n  }\n\n  /**\n   * \u4ECE\u540E\u7AEF\u52A0\u8F7D\u7ED8\u56FE\u72B6\u6001\uFF08\u6309\u7B26\u53F7\uFF09\n   * \u5F53\u7528\u6237\u6253\u5F00\u56FE\u8868\u6216\u5207\u6362\u7B26\u53F7\u65F6\uFF0CTradingView \u4F1A\u8C03\u7528\u6B64\u65B9\u6CD5\n   *\n   * @param {string} layoutId - \u56FE\u8868\u5E03\u5C40 ID\n   * @param {string|number} chartId - \u56FE\u8868 ID\n   * @param {string} requestType - \u8BF7\u6C42\u7C7B\u578B: 'mainSeriesLineTools' | 'lineToolsWithoutSymbol' | 'allLineTools' | 'studyLineTools'\n   * @param {LineToolsAndGroupsLoadRequestContext} requestContext - \u8BF7\u6C42\u4E0A\u4E0B\u6587\uFF0C\u5305\u542B symbol \u7B49\u4FE1\u606F\n   * @returns {Promise<Partial<LineToolsAndGroupsState> | null>}\n   */\n  async loadLineToolsAndGroups(layoutId, chartId, requestType, requestContext) {\n    this._log('loadLineToolsAndGroups:', { layoutId, chartId, requestType, requestContext });\n\n    // \u4ECE\u8BF7\u6C42\u4E0A\u4E0B\u6587\u4E2D\u83B7\u53D6\u7B26\u53F7\n    const symbol = requestContext?.symbol;\n    if (!symbol) {\n      this._log('loadLineToolsAndGroups: \u6CA1\u6709\u6307\u5B9A\u7B26\u53F7\uFF0C\u8FD4\u56DE null');\n      return null;\n    }\n\n    try {\n      // \u5E76\u884C\u52A0\u8F7D\u7ED8\u56FE\u548C\u5206\u7EC4\n      const [drawingsResult, groupsResult] = await Promise.all([\n        this._fetch(`/drawings/${encodeURIComponent(symbol)}`).catch(err => {\n          this._log(`\u52A0\u8F7D\u7ED8\u56FE\u5931\u8D25 (${symbol}):`, err.message);\n          return { drawings: {} };\n        }),\n        this._fetch(`/drawings/${encodeURIComponent(symbol)}/groups`).catch(err => {\n          this._log(`\u52A0\u8F7D\u5206\u7EC4\u5931\u8D25 (${symbol}):`, err.message);\n          return { groups: {} };\n        }),\n      ]);\n\n      // \u589E\u5F3A\u7684\u7C7B\u578B\u5B89\u5168\u68C0\u67E5\n      const rawDrawings = (drawingsResult && typeof drawingsResult.drawings === 'object' && drawingsResult.drawings !== null)\n        ? drawingsResult.drawings\n        : {};\n      const rawGroups = (groupsResult && typeof groupsResult.groups === 'object' && groupsResult.groups !== null)\n        ? groupsResult.groups\n        : {};\n\n      // \u6784\u5EFA Map \u683C\u5F0F\u7684 sources\n      const sources = new Map();\n      for (const [key, state] of Object.entries(rawDrawings)) {\n        sources.set(key, state);\n        // \u8BB0\u5F55\u6620\u5C04\u5173\u7CFB\n        this._setDrawingSymbol(layoutId, chartId, key, symbol);\n      }\n\n      // \u6784\u5EFA Map \u683C\u5F0F\u7684 groups\n      const groups = new Map();\n      for (const [key, drawingKeys] of Object.entries(rawGroups)) {\n        groups.set(key, drawingKeys);\n      }\n\n      this._log(`\u52A0\u8F7D\u4E86\u7B26\u53F7 ${symbol} \u7684 ${sources.size} \u4E2A\u7ED8\u56FE\u548C ${groups.size} \u4E2A\u5206\u7EC4`);\n\n      return {\n        sources,\n        groups,\n      };\n    } catch (error) {\n      console.error(`[SaveLoadAdapter] \u52A0\u8F7D\u7B26\u53F7 ${symbol} \u7ED8\u56FE\u5931\u8D25:`, error);\n      return null; // \u6839\u636E\u5B98\u65B9\u6587\u6863\uFF0C\u5931\u8D25\u65F6\u8FD4\u56DE null\n    }\n  }\n\n  // ==================== \u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\u8F85\u52A9\u65B9\u6CD5 ====================\n  // \u7528\u4E8E\u8FFD\u8E2A\u6BCF\u4E2A\u7ED8\u56FE\u5C5E\u4E8E\u54EA\u4E2A\u7B26\u53F7\uFF08\u652F\u6301\u5220\u9664\u64CD\u4F5C\u65F6\u627E\u5230\u76EE\u6807\u7B26\u53F7\uFF09\n  // \u4F7F\u7528 localStorage \u6301\u4E45\u5316\uFF0C\u907F\u514D\u9875\u9762\u5237\u65B0\u540E\u4E22\u5931\n\n  /**\n   * \u4ECE localStorage \u52A0\u8F7D\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\n   */\n  _loadDrawingSymbolMap() {\n    try {\n      const saved = localStorage.getItem(STORAGE_KEY);\n      this._drawingSymbolMap = saved ? JSON.parse(saved) : {};\n      this._log('\u5DF2\u52A0\u8F7D\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04:', Object.keys(this._drawingSymbolMap).length, '\u6761');\n    } catch (e) {\n      console.warn('[SaveLoadAdapter] \u52A0\u8F7D\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\u5931\u8D25:', e);\n      this._drawingSymbolMap = {};\n    }\n  }\n\n  /**\n   * P0-6 \u4FEE\u590D: \u9632\u6296\u4FDD\u5B58\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\u5230 localStorage\n   * \u6279\u91CF\u5408\u5E76 1 \u79D2\u5185\u7684\u5199\u5165\uFF0C\u51CF\u5C11 localStorage \u5199\u5165\u9891\u7387\n   * @param {boolean} immediate - \u662F\u5426\u7ACB\u5373\u4FDD\u5B58\uFF08\u7528\u4E8E\u9875\u9762\u5378\u8F7D\u7B49\u573A\u666F\uFF09\n   */\n  _saveDrawingSymbolMap(immediate = false) {\n    this._pendingSave = true;\n\n    // \u5982\u679C\u9700\u8981\u7ACB\u5373\u4FDD\u5B58\uFF0C\u53D6\u6D88\u73B0\u6709\u5B9A\u65F6\u5668\u5E76\u7ACB\u5373\u6267\u884C\n    if (immediate) {\n      if (this._saveDebounceTimer) {\n        clearTimeout(this._saveDebounceTimer);\n        this._saveDebounceTimer = null;\n      }\n      this._doSaveDrawingSymbolMap();\n      return;\n    }\n\n    // \u9632\u6296\uFF1A\u5982\u679C\u5DF2\u6709\u5B9A\u65F6\u5668\uFF0C\u4E0D\u91CD\u590D\u8BBE\u7F6E\n    if (this._saveDebounceTimer) {\n      return;\n    }\n\n    this._saveDebounceTimer = setTimeout(() => {\n      this._saveDebounceTimer = null;\n      this._doSaveDrawingSymbolMap();\n    }, SAVE_DEBOUNCE_MS);\n  }\n\n  /**\n   * P0-6: \u5B9E\u9645\u6267\u884C\u4FDD\u5B58\u64CD\u4F5C\n   */\n  _doSaveDrawingSymbolMap() {\n    if (!this._pendingSave) return;\n    this._pendingSave = false;\n\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this._drawingSymbolMap));\n      this._log('\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\u5DF2\u4FDD\u5B58');\n    } catch (e) {\n      console.warn('[SaveLoadAdapter] \u4FDD\u5B58\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\u5931\u8D25:', e);\n    }\n  }\n\n  /**\n   * P0-6 \u4FEE\u590D: \u8BBE\u7F6E\u8DE8\u6807\u7B7E\u9875\u540C\u6B65\u76D1\u542C\n   * \u5F53\u5176\u4ED6\u6807\u7B7E\u9875\u4FEE\u6539 localStorage \u65F6\uFF0C\u540C\u6B65\u66F4\u65B0\u672C\u5730\u7F13\u5B58\n   */\n  _setupStorageListener() {\n    // storage \u4E8B\u4EF6\u53EA\u5728\u5176\u4ED6\u6807\u7B7E\u9875\u4FEE\u6539\u65F6\u89E6\u53D1\uFF0C\u4E0D\u4F1A\u5728\u5F53\u524D\u9875\u9762\u89E6\u53D1\n    window.addEventListener('storage', (event) => {\n      if (event.key !== STORAGE_KEY) return;\n\n      this._log('\u68C0\u6D4B\u5230\u5176\u4ED6\u6807\u7B7E\u9875\u66F4\u65B0\u4E86\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04');\n\n      try {\n        if (event.newValue) {\n          const newData = JSON.parse(event.newValue);\n          // \u5408\u5E76\u7B56\u7565\uFF1A\u5176\u4ED6\u6807\u7B7E\u9875\u7684\u65B0\u6570\u636E\u4F18\u5148\uFF0C\u4F46\u4FDD\u7559\u672C\u5730\u72EC\u6709\u7684\u6761\u76EE\n          // \u8FD9\u907F\u514D\u4E86\u4E00\u4E2A\u6807\u7B7E\u9875\u5220\u9664\u53E6\u4E00\u4E2A\u6807\u7B7E\u9875\u6B63\u5728\u4F7F\u7528\u7684\u6620\u5C04\n          const merged = { ...this._drawingSymbolMap, ...newData };\n          this._drawingSymbolMap = merged;\n          this._log('\u5DF2\u5408\u5E76\u8DE8\u6807\u7B7E\u9875\u66F4\u65B0\uFF0C\u5F53\u524D\u6761\u76EE\u6570:', Object.keys(merged).length);\n        } else {\n          // \u5176\u4ED6\u6807\u7B7E\u9875\u6E05\u7A7A\u4E86\u6570\u636E\uFF0C\u8FD9\u91CC\u4E0D\u505A\u5904\u7406\uFF0C\u4FDD\u7559\u672C\u5730\u6570\u636E\n          this._log('\u5176\u4ED6\u6807\u7B7E\u9875\u6E05\u7A7A\u4E86\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\uFF0C\u672C\u5730\u6570\u636E\u4FDD\u6301\u4E0D\u53D8');\n        }\n      } catch (e) {\n        console.warn('[SaveLoadAdapter] \u5904\u7406\u8DE8\u6807\u7B7E\u9875\u66F4\u65B0\u5931\u8D25:', e);\n      }\n    });\n\n    // \u9875\u9762\u5378\u8F7D\u524D\u786E\u4FDD\u4FDD\u5B58\u6240\u6709\u5F85\u4FDD\u5B58\u7684\u6570\u636E\n    window.addEventListener('beforeunload', () => {\n      if (this._pendingSave) {\n        this._saveDrawingSymbolMap(true); // \u7ACB\u5373\u4FDD\u5B58\n      }\n    });\n\n    this._log('\u8DE8\u6807\u7B7E\u9875\u540C\u6B65\u76D1\u542C\u5DF2\u8BBE\u7F6E');\n  }\n\n  /**\n   * \u83B7\u53D6\u5B58\u50A8 key\n   */\n  _getDrawingMapKey(layoutId, chartId, drawingKey) {\n    return `${layoutId || 'default'}/${chartId}/${drawingKey}`;\n  }\n\n  /**\n   * \u8BB0\u5F55\u7ED8\u56FE\u4E0E\u7B26\u53F7\u7684\u6620\u5C04\uFF08\u81EA\u52A8\u6301\u4E45\u5316\u5230 localStorage\uFF09\n   */\n  _setDrawingSymbol(layoutId, chartId, drawingKey, symbol) {\n    if (!this._drawingSymbolMap) {\n      this._drawingSymbolMap = {};\n    }\n    this._drawingSymbolMap[this._getDrawingMapKey(layoutId, chartId, drawingKey)] = symbol;\n    this._saveDrawingSymbolMap(); // \u6301\u4E45\u5316\u5230 localStorage\n  }\n\n  /**\n   * \u83B7\u53D6\u7ED8\u56FE\u5BF9\u5E94\u7684\u7B26\u53F7\n   */\n  _getDrawingSymbol(layoutId, chartId, drawingKey) {\n    if (!this._drawingSymbolMap) return null;\n    return this._drawingSymbolMap[this._getDrawingMapKey(layoutId, chartId, drawingKey)];\n  }\n\n  /**\n   * \u79FB\u9664\u7ED8\u56FE\u7B26\u53F7\u6620\u5C04\uFF08\u81EA\u52A8\u6301\u4E45\u5316\u5230 localStorage\uFF09\n   */\n  _removeDrawingSymbol(layoutId, chartId, drawingKey) {\n    if (!this._drawingSymbolMap) return;\n    delete this._drawingSymbolMap[this._getDrawingMapKey(layoutId, chartId, drawingKey)];\n    this._saveDrawingSymbolMap(); // \u6301\u4E45\u5316\u5230 localStorage\n  }\n\n  /**\n   * \u6E05\u7406\u8FC7\u591A\u7684\u65E7\u6620\u5C04\u6570\u636E\uFF0C\u9632\u6B62 localStorage \u65E0\u9650\u589E\u957F\n   * \u5F53\u6620\u5C04\u6761\u76EE\u8D85\u8FC7 MAX_ENTRIES \u65F6\uFF0C\u5220\u9664\u6700\u65E9\u7684\u4E00\u534A\n   */\n  _cleanupOldMappings() {\n    const MAX_ENTRIES = 1000; // \u6700\u5927\u4FDD\u7559\u6761\u76EE\u6570\n\n    if (!this._drawingSymbolMap) return;\n\n    const keys = Object.keys(this._drawingSymbolMap);\n    if (keys.length <= MAX_ENTRIES) return;\n\n    // \u5220\u9664\u524D\u4E00\u534A\u7684\u6761\u76EE\uFF08\u5047\u8BBE\u8F83\u65E9\u6DFB\u52A0\u7684\u5728\u524D\u9762\uFF09\n    const toRemoveCount = Math.floor(keys.length / 2);\n    const toRemove = keys.slice(0, toRemoveCount);\n\n    toRemove.forEach(key => delete this._drawingSymbolMap[key]);\n    this._saveDrawingSymbolMap();\n\n    this._log(`\u6E05\u7406\u4E86 ${toRemoveCount} \u4E2A\u65E7\u7684\u7ED8\u56FE\u6620\u5C04\uFF0C\u5F53\u524D\u5269\u4F59 ${keys.length - toRemoveCount} \u6761`);\n  }\n\n}\n\n// \u5BFC\u51FA\nexport default SaveLoadAdapter;\n", "/**\n * SaveLoadAdapter \u6E90\u7801\u5165\u53E3\uFF08\u540E\u7EED\u7531\u6784\u5EFA\u8F93\u51FA\u5230 public/saveLoadAdapter.js\uFF09\n */\n\nimport SaveLoadAdapter from './save-load-adapter.js';\nexport default SaveLoadAdapter;\n\n\n"],
  "mappings": "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",
  "names": []
}
