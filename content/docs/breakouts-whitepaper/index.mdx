---
title: 突破研究白皮书
description: 价格行为中突破与反转的研究结论
---

## 引言

这份文档，记录了我关于价格行为（Price Action）中**突破**与**反转**的研究结论。

我在 2019 年做过一次系统性研究。起因很简单：我写了第一版新代码，用来识别**强突破**与**强反转**。交易编程要写得对，底层必须有可靠的统计研究支撑。代码跑通只是第一步；下一步，是把市场行为的“底层规律”吃透，把它量化出来——这样我才能验证软件逻辑，并把参数调到更优。

这份报告，就是那次研究项目的完整产出。它对我理解市场行为的影响非常直接、非常深刻——以至于我现在相信：**做价格行为交易，真正要懂的核心概念，就在这里。**

后来我迭代了多轮规则与代码，把信号发给 Al Brooks 博士，请他点评。他的回复很短，但正是我最想听到的那句话：
“……它把我想交易的那些 K 线全都识别出来了。”

文中所有图表，都是标普 500 e-mini 期货合约（ES）的 **5 分钟日内图**，由 TradeStation 生成。

我刻意把这份报告写成“研究报告”，而不是学术论文：**直白、教学、好读**，尽量让交易者读得进去，而不是被学术表达劝退。

这是一份更新修订版，用来回应读者反馈——主要是补足一些段落，让大家能更完整地理解我讨论的细微差别。

希望这份信息对你有用，并能把你的交易水平推上一个台阶。

此致
Ali Moin-Afshari
加拿大安大略省 Richmond Hill
2023 年 11 月

---

## 价格行为突破

文献里对“价格行为突破”的定义是：

> 只要价格比上一根 K 线的高点或低点，多走出 1 Tick，就算突破。

这是“突破”的最低门槛。问题在于：**突破会失败，也会成功**。

- **失败**：没有跟随（follow-through），市场在下一根 K 线就反转。
- **成功**：至少还有 1 根 K 线继续朝同方向走（也就是出现跟随）。

---

### 跟随的重要性

为什么“跟随”这么关键？原因很简单：**单根突破不算数，市场要用下一根来“盖章确认”。**

看下面两张图。它们都在第 2 根 K 线上形成突破，但后续结局完全不同。

第 2 根 K 线，可以视为对第 1 根高点的突破。收盘时，价格不但远离第 1 根高点，而且**收在第 1 根高点之上**。

到这里为止，这是一个“看起来不错”的突破。但经验交易者还会等下一根：**跟随 K 线**。

![图 1](/images/breakouts-whitepaper/figure-01.png)

![图 2：突破 vs. 失败的突破](/images/breakouts-whitepaper/figure-02.png)

---

### 突破的大小

突破走得有多远，是决定它后续能不能继续获得更多跟随的关键因素。

- 突破如果把价格推得更远，通常更容易出现：
  - 更多同向 K 线
  - 第二段腿、第三段腿

“大（或更大）的走法”，尤其是包含不止 1～2 根 K 线时，往往会**把交易者套住**。被套的人通常有两类：

- 押注突破会失败的人：被套进亏损仓位
- 怀疑突破、不敢参与的人：被套在场外，错过盈利行情

---

## 第二段腿

这两类人都会拼命等一个东西：**回调**。

- 持亏损仓位的人，希望回调让他们以更小亏损退出
- 错过的人，希望回调给他们“打折上车”的机会

但现实往往是：回调来了也**短、浅**。为什么？因为这两类“被套人群”的需求叠加，形成强烈的买入/卖出承接，市场根本回不深。

还有第三类人：**顺势**交易者。他们早早进场，仓位却不够大——当时那笔交易只是“可能是一般概率甚至偏低概率”。现在突破确认了，他们反而觉得：早知道就下大点。他们也想等回调来**加码**，把仓位补到符合账户规模的位置。

这一整套动力，会自然催生**第二段腿**。

我的研究结论是：**等第一段腿足够强，然后去交易随后出现的第二段腿，是概率最高的入场方式**——成功率大约 **80％**。

如果交易者还能再过滤掉一些建仓形态（特殊情况），胜率会更高，甚至能接近 **90％**。在所有例外与特殊情况里，对胜率贡献最大的那条规则是：

- **避开“晚腿”**
  - 这里的“晚”指：市场在同方向已经走出 2 段腿之后，再出现的新强腿
  - 也就是说：第 3 段、第 4 段及之后的腿，用来押第二段腿的概率显著降低

---

## 急速

**急速（Spike）**，指的是一段没有回调的价格腿。只要出现回调，急速就结束，市场会进入：

- 通道（Channel），或
- 反转（Reversal）

文献里常把“一根很大的 K 线”称为急速，但实际交易与研究里，通常至少需要 **连续 2 根**同向 K 线（单根可能只是突破K线或缺口）。为什么必须这样？对比下图的多头与空头急速，你就会明白。

比如：第 16 根是空头反转K线，但那时多头急速仍在上行，而且此前还没有回调。虽然第 16 根是逆势 K 线，但它还没破坏连接过去 5～6 根低点的多头趋势线。直到第 17 根跌破第 16 根低点，多头急速才真正结束。

同样的逻辑也发生在 17～18 之间。第 18 根是弱多头反转K线，但它也是从第 16 根开始、并在第 17 根获得抛压跟随的小空头急速的一部分。只有当第 19 根的高点突破第 18 根高点，小空头急速才结束。

![图 3：红色 K 线标出多头急速的终止点](/images/breakouts-whitepaper/figure-03.png)

也就是说：每一个波段点附近，都会有一根 K 线负责“拐点落地”。这根 K 线经常同时属于：

- 正在结束的旧急速
- 即将开始的新急速

因此，急速至少要有 **2 根 K 线**才成立。再进一步：为了写代码可靠，我们也至少需要 2 根。

![图 4：绿色 K 线标出空头急速的终止点](/images/breakouts-whitepaper/figure-04.png)

建议你花几分钟，把上面两张图对照着看：同一个转折点，多头与空头各有各的“理”。多头看到的是：急速还在，概率上还能延续；空头看到的是：反转信号已经出现，可能引发一段大的反向走法。于是市场控制权在这些点位上激烈争夺。

---

## 内包K线

另一个快速观察：\*\*内包K线（Inside Bar）\*\*也是急速的一部分，即便它方向与急速相反。

但更细看会发现：从内包K线启动的反转或突破，似乎更容易**失败**，并且更快进入回调。图 5 用黑色标出内包K线。内包K线意味着区间压缩，通常对应低时间级别上的三角形。

![图 5：内包K线（黑色）](/images/breakouts-whitepaper/figure-05.png)

---

## 外包K线

多数图表里也会出现少量**外包K线（Outside Bar）**：它的高点高于前一根高点、低点低于前一根低点。外包K线在低时间级别上对应“扩张三角形”。内包K线与外包K线，本质上都是微观尺度的交易区间变体，只是被高时间周期压缩成 1～2 根 K 线呈现出来。

图 6 是同一张 ES 图，这次只把外包K线涂色。

![图 6：外包K线](/images/breakouts-whitepaper/figure-06.png)

我写的 PaintBar 指标，会按外包K线的多空倾向去涂色。比如：

- 第 32 根是多头 K 线，但被涂成橙色（我给“偏空外包K线”的颜色）
- 第 22、58 根是空头 K 线，但被涂成绿色（我给“偏多外包K线”的颜色）

外包K线倾向的判定逻辑，是本研究的发现之一，后文会解释。

---

## 高潮K线

我用一种方法，在算法层面识别那些“很可能成为买入高潮或卖出高潮”的大 K 线。技术细节写在《AMA\_Breakouts\_PB Technical Guide》里。下图中被涂色的 K 线，符合我的“高潮”标准。

一般预期是：高潮后 **1～3 根 K 线**之间会开始回调。这些回调通常以反转形态开局，但反转失败，趋势未必被逆转，反而常常会带来至少一段继续顺势的腿。

但如果高潮信号出现在“晚腿”（趋势方向的最后 1～2 段腿）里，它往往会带来更持久的回调，甚至直接反转。

多数趋势起步，来自市场处于突破模式（Breakout Mode）后的强突破。某个时刻，突破急速会出现回调，急速结束，趋势进入通道阶段。通道阶段通常至少有 2 段腿，其中一段或两段可能还包含更复杂的内部腿（夹杂短回调）。我们把**第二段腿之后**、仍然顺势的任何腿称为“晚腿”。

![图 7：代码识别出的多头与空头高潮](/images/breakouts-whitepaper/figure-07.png)

---

## 研究范围

这次研究，我想量化两件事：

- 突破之后出现跟随的概率
- 强反转之后出现跟随的概率

为了定义清楚、可量化，我把研究范围限定在以下几类信号。

### 1）突破

两根 K 线的突破形态，需满足：

- a. 两根里至少有一根，K 线区间大于过去 10 根的平均区间范围 \[1]
- b. 第 2 根可以收在第 1 根之外，也可以不收在之外；但必须与第 1 根同方向，才算“突破 + 跟随”
  - 换句话说：跟随 K 线不必收在突破K线之外，只要同方向即可
- c. K 线必须强：
  - 多头 K 线 IBS ≥ 69
  - 空头 K 线 IBS ≤ 31
  - IBS 的定义后文解释
- d. 突破K线可以同时也是反转K线

### 2）大突破

1～2 根 K 线，其中至少有一根是“大 K 线”：

- a. 大 K 线：区间 > 过去 10 根平均区间的 2 倍
- b. K 线必须强：
  - 多头 IBS ≥ 69
  - 空头 IBS ≤ 31
- c. 大突破K线也可以同时是反转K线

### 3）反转

两根 K 线的反转形态，需满足：

- a. 两根的区间至少等于过去 10 根平均区间，但又不足以称为突破K线
- b. 第 2 根必须收在第 1 根高点之上（多头情形；空头相反）
- c. 信号K线 IBS：
  - 多头反转K线 IBS ≥ 69
  - 空头反转K线 IBS ≤ 31

### 4）外包K线

外包K线的高点 > 前一根高点，低点 < 前一根低点。另有两种变体：

- a. 两根低点同价，但当前 K 线高点 > 前一根高点
- b. 两根高点同价，但当前 K 线低点 < 前一根低点

### 5）高潮K线

- a. 高潮K线是大 K 线，大小与突破/大突破相近
- b. 不能是反转K线
- c. 必须按趋势方向突破，幅度达到 `CXfactor × 1.6`
  - 其中 `CXfactor` 是高潮因子（climax factor），至少 1.6（细节见《AMA\_Breakouts\_PB Technical Guide》第 5 页）

---

## 方法论

可靠研究，必须建立在：

- 正确的研究设计
- 有效的样本收集
- 无偏的数据分析

下面是我的方法论。

---

### K 线方向

“K 线方向”看似小事，但量化交易里必须客观定义所有东西。为此我在 paintbar 代码里写了一个小算法来判定方向：从宽泛、明显的条件开始，一步步收紧到更具体的条件。

```text
//--- Bar Direction ---
{
Classify bars based on their direction into only two categories, either BL (+1) or BR (-1)
}
If C > O And IBS >= 50 Then
    BarDir = 1
Else
If C < O And IBS <= 50 Then
    BarDir = -1
Else
If C = O And IBS > 50 Then
    BarDir = 1
Else
If C = O And IBS < 50 Then
    BarDir = -1
Else
If C = O And IBS = 50 Then
    BarDir = BarDir[1]
Else
If C < O And IBS > 50 Then
    BarDir = 1
Else
If C > O And IBS < 50 Then
    BarDir = -1
Else
If IBS = 50 Then
    BarDir = BarDir[1]
Else
    BarDir = BarDir[1];
```

它覆盖的情况包括：

- 实体方向与收盘位置同向
- 没实体的十字星
- 实体方向与 K 线方向冲突（实体与收盘倾向不一致）
- 完美十字星：无论实体方向如何，都继承上一根方向
- 其他类型：继承上一根方向
- 兜底条件（catch-all）

---

### 数据构成

针对上面 5 类突破/反转标准，我在 ES 的 **5 分钟图**上（常规交易时段 RTH）为每类收集了 **100 笔**样本。

为了让样本分布真正代表“一个典型月里常见的日内结构”，我先基于更早的日结构研究，把交易日分成几类（典型月里大致占比）：

- TRD（Trading Range Day）：至少 4 小时处于交易区间：**86％**
- TTRD（Trending Trading Range Day，全天）：**65％**
- 趋势或通道：**10～15％**
- 全天小回调趋势：**5％**

TRD 是一个总括概念：日内结构主要表现为交易区间。那种从开盘就在图表一角，斜直线一路走到对角、收盘落在另一角的“教科书趋势日”，其实很少见。多数日内图，就算一天里有一段在趋势，也仍然充满双向交易。

而交易区间又有不同形态，所以“日结构”（即日内价格结构）也会有子分类：

- 如果一天整体横向，能用一个矩形框住：这是 TRD
- 如果开盘区间很宽，随后逐步压缩，收盘前看起来像三角形：这是 TRI TRD（TRIangle Trading Range Day）
- 如果全天不断刷新日内高低点，形成扩张三角形，且包含趋势腿：这是 ET TTRD（Expanding Triangle Trending Trading Range Day）

更常见的交易区间日，是 TTRD：由“趋势腿 + 交易区间阶段”交替组成。TTRD 还有更细的子类，但超出本报告范围。你需要记住的核心是：

- 大约 **65％** 的交易日属于某种 TTRD
- 大约 **85％** 的交易日，会有约半天时间处于某种交易区间

在整理回测数据时，我刻意贴合这些倾向，确保研究数据能代表真实市场行为。

另外注意：

1. 各类市场状态的日内价格行为，都由上述日结构按这些比例构成；对日内交易者而言，大盘大级别“市场状态”没那么重要
2. 回测要有效，样本日的日型分布必须接近典型月的分布
3. TTRD 是 TRD 的子集
4. 因此，大约 20％ 的 TRD 会更偏趋势，或更极端地偏交易区间
5. 我会结合高时间周期背景做调整：当日线趋势明显时，会在 TRD 样本里加入更多“偏趋势的 TRD”
6. 如果 VIX 图上一根 K 线跨越阈值：当 K 线大部分落在哪个区间，就归到哪个波动区间
7. 优先使用更近的历史数据，而不是更旧的数据
8. 初步观察发现，多数交易日大约有 **20 个**信号。我在各波动区间里抽取足够多的交易日，保证每个建仓形态至少 **100 笔**交易样本

---

### 市场状态

我还在 3 个不同波动区间下，各取了 **100 笔**样本。波动区间由下列 VIX 范围定义。VIX 是 CBOE 波动率指数，由 SPX 指数近月 Put 期权隐含波动率计算得出。VIX 常被称为“恐慌指数”：当交易者担心回调或大幅下跌，会买入 Put 做对冲或保险；下跌时 Put 价值上升。

我用的 3 个波动区间定义如下：

| 波动区间 | VIX 范围 |
| ---- | ------ |
| 低    | 0～15％  |
| 中    | 15～30％ |
| 高    | ＞ 30％  |

![图 8：基于 VIX 的市场状态](/images/breakouts-whitepaper/figure-08.png)

图 9 展示了按这些区间涂色后的 VIX 图，用来说明市场状态切换。

![图 9：VIX 区间标出市场状态变化](/images/breakouts-whitepaper/figure-09.png)

---

### 样本识别

我写了一段代码，实现两件事：

1. 通过涂色标记建仓形态
2. 从图表抓取价格数据，并存入 Excel

---

### 内部K线强度（IBS）

技术分析文献里常用内部K线强度（Internal Bar Strength，IBS）来表达单根 K 线的方向倾向。它用收盘价在 K 线区间中的位置来计算：

```javascript
IBS = (Close - Low) / Range x 100
```

IBS 总是用百分比表示。例如：

- 强多头 K 线若收在接近高点或就在高点：IBS 通常在 **80％～100％**
- 同样强的空头 K 线：IBS 通常在 **0～20％**
- 收在区间中部附近的十字星：IBS 大约 **45％～55％**

多头 K 线收在高点（左）：IBS = 100％
空头 K 线收在低点（右）：IBS = 0％

![图 10：强 K 线 IBS 示例](/images/breakouts-whitepaper/figure-10.png)

本研究使用以下 IBS 过滤阈值（-1 表示不做过滤）：

| 过滤项          | 最小 IBS％ |
| ------------ | ------- |
| \_BullBOIBS  | 69      |
| \_BearBOIBS  | 31      |
| \_BullRevIBS | 51      |
| \_BearRevIBS | 49      |
| \_BullFTIBS  | -1      |
| \_BearFTIBS  | -1      |

![图 11：IBS 过滤值](/images/breakouts-whitepaper/figure-11.png)

---

### 样本分析

电脑识别出的每一笔样本，我都人工复核。很枯燥，但必须做：只有这样你才知道“信号在真实语境里到底在干什么”，进而把算法设计得更稳、更耐用。

我把结果录入一份新 Excel 文件（我写了计算逻辑），用来计算系统化交易里最常用的统计指标：

- T-Score 或 SQN（System Quality Number）\[3]
- R 的标准差 \[4]
- 平均 R（系统期望值）\[5]
- 胜率
- 平均亏损

所有测量都以 **R 倍数**记录。\[6]

---

## 初始试跑

正式做长周期研究之前，我先做了几次小规模试跑，用来摸清规则应该怎么写。

这一步在交易研究里非常关键，因为你一开始并没有彻底理解你在研究的概念。小规模测试会很快告诉你：

- 哪些地方要特别小心
- 哪些东西必须关注
- 哪些规则需要删掉或改写
- 怎么改才更合理

当你对概念有了总体把握，才值得进入更正式、更长周期的研究。说白了：前几次快跑，就是判断这件事值不值得继续投入时间与精力；如果值得，也能指明怎么做才最有效。

---

## 交易技术

我要强调一点：我做这个项目，是为了给我自己开发交易技术。每个人都不同。你越了解自己是什么类型的交易者，就越能设计出适合你的系统与策略。

我并不指望所有人都能用这些技术，或者觉得舒服。事实上，多数交易者很难用限价单交易，而这正是更适合我的风格。

带着这个前提，我们来看我测试的入场技术。

![图 12：收盘买入（BTC）入场示例](/images/breakouts-whitepaper/figure-12.png)

**图 12（Buy-The-Close，BTC）标注说明：**

- BO Distance：按第 2 根高点下方 1 Tick 计算，便于限价单退出
- BTC：形态完成时入场
- 第 2 根向上突破第 1 根收盘
- BTC：在第 1 根收盘入场
- 早入场（第 1 根收盘）的 1R 距离
- iStop
- 第 2 根突破幅度，用百分比表达，相对第 1 根 BTC 入场的 R 值
- `B2 BO = ((H2 - 1 Tick) - C1) / (C1 - (L1 + 1 Tick))`

---

### 市价入场

信号K线收盘后立刻点击“Buy”或“Sell”，交易平台生成市价单，立即成交。

---

### 分批加仓

强 K 线之后，市场通常会回调。我测试了“有分批加仓”和“无分批加仓”的两种做法。分批加仓的细节超出本报告范围，但一个通用原则是：

- 往左看，找合理的支撑/阻力位
- 用这些价位来规划限价单的分批加仓点

---

### 初始止损

我喜欢用宽止损，但宽止损不是不止损。为简化并量化，我用信号K线区间来确定初始止损（iStop），如图 12 所示。

![图 13：初始止损（iStop）示例](/images/breakouts-whitepaper/figure-13.png)

在以下情形下，我会调整 iStop：

1. 信号K线相对较小：iStop 距离 = 信号K线区间的 2 倍
2. 信号由两根构成：iStop 距离 = 两根合计区间的 2 倍
3. 信号K线远大于平均：iStop = 1 倍区间 + 若干 Tick，把止损放在信号下方不远处

---

## 过滤条件

做完最初几轮快速测试后，我决定除 IBS 过滤外（见图 11），再加两条过滤：

- 不做同方向连续第 3 个信号
- 不做通道第 3、4 段腿里的信号
  - 这条不是上一条的换说法
  - 因为：每段腿可能起始于突破信号，也可能不产生信号就自然形成
  - 这种情况下，“信号次数过滤”抓不住“晚突破”，但“腿数过滤”能抓住
  - 所以两者并不互斥

第一次正式测试后（结合发现），我决定再加一条过滤。第二次测试使用 3 条过滤：

- 不做同方向连续第 3 个信号
- 不做通道第 3、4 段腿里的信号
- 不做美东时间（EST）上午 10:10 之前形成的信号

---

## 研究结果

图 14 是突破信号汇总（来自我的研究文档）。

![图 14：突破信号汇总结果](/images/breakouts-whitepaper/figure-14.png)

图 15 是获得跟随的反转信号汇总（同一文档）。

![图 15：强反转 + 跟随汇总结果](/images/breakouts-whitepaper/figure-15.png)

需要注意：任何回测都不可避免有偏差。部分偏差来自回测执行与实盘执行的差异：实盘并不完美，会受交易者错误影响，包括漏单、执行不精确等。

因此，我们通常会寻找在回测中表现足够强的策略，让它的优势（Edge）大到足以覆盖实盘不可避免的瑕疵，而不会把策略钝化到失效。也就是说：我们希望有多出来的“优势资本”，用来支付实盘中的失误、漏交易、执行偏差。

---

### 图 14 表格摘录（突破信号汇总）

**测试 1**

| 指标    | 不分批加仓   | 分批加仓    |
| ----- | ------- | ------- |
| 胜率    | 83％     | 82％     |
| 净盈利   | 58.46 R | 86.77 R |
| 总盈利   | 67.19 R | 90.77 R |
| 总亏损   | -8.73 R | -4.00 R |
| SQN   | 7.4     | 10.9    |
| 标准差   | 0.93    | 0.94    |
| 中位数 R | 0.94    | 1.24    |
| 众数    | -1      | 0       |
| 平均 R  | 0.8     | 1.2     |

**测试 2**

| 指标    | 不分批加仓   | 分批加仓    |
| ----- | ------- | ------- |
| 胜率    | 86％     | 86％     |
| 净盈利   | 56.03 R | 81.69 R |
| 总盈利   | 58.95 R | 81.69 R |
| 总亏损   | -2.92 R | 0.00 R  |
| SQN   | 8.9     | 13.9    |
| 标准差   | 0.79    | 0.74    |
| 中位数 R | 0.94    | 1.30    |
| 众数    | 1       | 0       |
| 平均 R  | 0.9     | 1.3     |

---

### 图 15 表格摘录（强反转 + 跟随 汇总结果）

**测试 1**

| 指标    | 不分批加仓   | 分批加仓     |
| ----- | ------- | -------- |
| 胜率    | 88％     | 88％      |
| 净盈利   | 69.32 R | 112.01 R |
| 总盈利   | 79.32 R | 114.01 R |
| 总亏损   | -10 R   | -2 R     |
| SQN   | 6.9     | 12.2     |
| 标准差   | 1.14    | 1.04     |
| 中位数 R | 0.77    | 1.21     |
| 众数    | -1      | 0        |
| 平均 R  | 0.9     | 1.4      |

**测试 2**

| 指标    | 不分批加仓   | 分批加仓     |
| ----- | ------- | -------- |
| 胜率    | 99％     | 99％      |
| 净盈利   | 78.32 R | 114.01 R |
| 总盈利   | 79.32 R | 114.01 R |
| 总亏损   | -1 R    | 0 R      |
| SQN   | 9.8     | 14.9     |
| 标准差   | 0.96    | 0.90     |
| 中位数 R | 0.90    | 1.30     |
| 众数    | 1       | 1        |
| 平均 R  | 1.1     | 1.6      |

---

## 如何理解这些结果

系统化交易者用 SQN（本质上是学生 t 检验）来给系统做“可靠性与表现”的分级，从而决定风险与敞口参数，以便设计合适的资金策略。虽然细节超出本报告范围 \[2]，但图 16 给出一个高层摘要：

| SQN       | 系统评级        |
| --------- | ----------- |
| ＜ 1.00    | 非常难交易，甚至不可能 |
| 1.01～1.69 | 差到一般        |
| 1.70～2.00 | 一般，但统计显著    |
| 2.01～3.00 | 好系统，显著不同于 0 |
| 3.01～5.00 | 很棒          |
| 5.01～7.00 | 优秀          |
| ＞ 7.00    | 顶级          |

![图 16：SQN 值概览](/images/breakouts-whitepaper/figure-16.png)

把我的研究汇总结果放进上面的 SQN 分级里，你会发现：突破信号与反转信号不仅有效，而且可以作为高性能系统的基础。

---

# 突破信号

## 为什么突破建仓形态重要

### 1）它是一次“大意外”

突破建仓形态出现时，价格在很短时间（1 根 K 线）里显著单向移动（超过平均 K 线区间）。本研究包含 **308** 根突破信号K线，其中 **148** 根得到了跟随 K 线。因此，突破K线在下一根立即得到跟随的概率约 **48％**。

BO + FT 的概率并不高，这意味着它是一种“意外”。意外通常会有第二段腿。

### 2）它出现得足够频繁

虽然是意外，但 BO + FT 的出现频率足以提供统计意义上的样本量，作为可行交易信号。ES 的 5 分钟日内图上，平均每张图大约 **5 个**形态，约占 K 线数量的 **12％**。

### 3）它足够“多用”

研究显示，这个形态可以用不止一种方式交易，因此它很“通用”。它能在不同背景下提供不同机会，帮助交易者快速估算概率，并让自己的交易节奏与市场意图对齐。

---

## 立即跟随的概率：48％，但到 1R 的概率只有 22％

在形态第 2 根 K 线收盘后，立即出现跟随的概率 **＞ 48％**。但同时：

1. 跟随达到 1R 目标的概率只有 **22％**
2. 达到 2R 的概率约 **5％**

反过来，当出现立即跟随时：

- 第二段腿小于第一段腿的概率是 **26％**
- 更容易出现更深回调（PB ＞ 0.5R）

细节数据：

1. 多数立即跟随的走势不超过 **1 根**（平均 **1.04 根**）
2. 连续 **3 根**或以上的概率只有 **16％**；连续 **5 根**或以上的长串概率只有 **3％**
3. 立即跟随小于 **0.5R** 的概率 **＞ 70％**

---

## 突破建仓形态后的第二段腿概率：＞ 90％

出现第二段腿的概率非常高：

- 第二段腿区间 ≥ 第一段腿的概率：**64％**
- 第二段腿区间 > 第一段腿的概率：**42％**（以 Tick 或点数衡量）
- 第二段腿只有 **1 根**同向 K 线的概率：**14％**
  - 也就是说：第二段腿同向 K 线 **＞ 1 根**的概率非常高（**83％**）
- 完全没有第二段腿的概率：**2％**
- **77％** 的形态发生在第 1、2 段腿中
  - 趋势早期更容易出现急速与高动能
  - 与第 3 段及之后同样大小（K 线区间）的信号相比，早期信号更容易带来可交易的第二段腿

---

## 时间维度

按时间切片的样本量偏小，但结果仍有指向性：

- **开盘**：多数发生在 9:30～10:05 AM 的形态，产生亏损交易的失败概率 **＞ 70％**
  - 这意味着：开盘时押注突破失败（Fade 突破），是统计显著策略
  - 下一项研究（反转）也支持这一发现：开盘发生的反转形态胜率非常高
- **10:10～11:55**：若能分批加仓，胜率 **＞ 90％**
- **12:00～13:55**：第 2 段及之后的形态失败率更高；多数第 3、4 段腿形态在此时段失败
- **2:00～2:55 PM**：与 10:10～11:55 类似，若能分批加仓，成功概率几乎相同
- **收盘**：无法对最后 40 分钟得出同样结论

---

## 微型缺口（MIG）\[7]

微型缺口的存在，会显著改变概率。

1. 若形态内出现 MIG（由第 2 根形成），且形态在第 1 或第 2 段腿里：
   - 在第 2 段腿中成为盈利交易的概率 **97％**
   - 其余多数为盈亏平衡点退出
   - 亏损达到 -1R（或更大）的概率 **＜ 2％**
   - 以上数据基于“主动管理（分批加仓）”
   - 若不主动管理：亏损多数仍小于 -1R，且亏损大于 -1R 的概率同样约 **2％**
2. 若形态之后出现 MIG（由跟随 K 线形成），且形态在第 1 或第 2 段腿里：
   - 亏损概率 **＜ 10％**
   - 分批加仓大多可避免这些亏损
3. 若形态发生在第 3 或第 4 段腿，MIG 反而有负面影响：
   - 盈利超过 1R 的概率只有 **5％**
   - **79％** 概率为盈亏平衡点或小亏
   - 换句话说：晚腿里做反向交易约有 **80％** 胜率
   - 样本量小，但暗示：晚腿 MIG 会增强高潮性质，更容易走向“高潮反转”而非跟随延续

---

## 先扫止损，再走第二段腿

1. 第二段腿开始前出现扫止损（stop run）的概率：**21％**
2. 其中第 3、4 段腿形态失败的比例：**80％**
3. 第 1、2 段腿里的扫止损，在分批加仓下可修复
4. 不论腿数，若扫止损幅度 ＜ 形态区间的 **50％**，分批加仓可修复
5. 不论腿数，若扫止损幅度 ＞ 形态区间的 **50％**，最多只有 **15％** 概率能靠分批加仓修复

---

## 回调深度与持续时间（PB）

- **回调 K 线数量**：平均 **3 根**，最多可到 **7～11 根**；达到 **12 根**或更多的概率显著更低
- **回调深度**：
  1. 回调在 0～0.5R（突破区间 0～50％）的概率：**58％**
  2. 回调 ＞ 1R 的概率：**21％**
     - 以多头为例：回调跌破多头突破K线低点，但没形成空头趋势，随后多头恢复
  3. 第 1、2 段腿里，深回调（≥ 1R）的回撤通常可通过分批加仓修复；晚腿里这类往往不是回调，而更像突破
  4. 0.75R 的深回调出现频率 **42％**，也是盈亏平衡点或亏损最多的情形
     - 这种深度的形态失败约 **45％**
     - 强烈建议快速退出或盈亏平衡点退出
     - 第 1、2 段腿还有较大机会修复，但第 3、4 段腿中 **＞ 90％** 的深回调交易会失败
     - 这里的“失败”指：它变成了反转，而不是延续形态（回调应是延续形态）
  5. 回调小于 0.75R 的形态，亏损概率只有 **10％**，可通过分批加仓修复

---

## 建仓形态类型

基于突破信号，形态主要分两类：

1. **反转突破**：强反转，且反转那根足够大，满足突破K线标准
2. **突破**：顺当前趋势方向的大 K 线，或新腿中后续 K 线（该腿可能由更小的 K 线起步）

---

## 交易生命周期

形态完成后，市场平均用 **8 根 K 线**（在 5 分钟图上约 **40 分钟**）：

- 先回调（1～3 根）
- 再走出第二段 1R 腿（约 4 根，加上信号K线）

最长交易持续 **28 根**，也有不少 **10 根**左右的案例。

---

## 跟随阶段出现微型缺口

当跟随产生微型缺口，或形态内已有微型缺口时，深回调更少见。

---

## 立即跟随

出现立即跟随时，市场平均继续 **2 根**左右，并沿形态方向走出约 **1R**。但不发生任何回调就直接到 1R 的概率只有 **22％**。

---

## R 倍数分布分析

我用两种方式测量 R 倍数：

1. 在信号第 2 根（跟随 K 线）入场，持有到 1R：
   - 测试 1：SQN 7.4
   - 测试 2：SQN 8.9
2. 在第 1 根（突破K线）入场，并在回调中加仓，目标 1R：
   - 测试 1：SQN 10.9
   - 测试 2：SQN 13.9

这里的 1R，指第二段腿大约等于突破信号K线的大小；若形态由两根构成，则等于两根合计大小（见图 12）。

但我这项研究的目标，是找出形态的概率，以及价格行为细节如何影响这些概率。因为在实盘里，很少有交易者能把仓位拿到足以捕捉整段腿的完整区间。

---

## 过滤条件设计

回测显示：剔除第 3、4 段腿里的形态，会显著改善系统表现：

1. 测试 1：
   - 胜率从 76％ 提升到 83％
   - SQN 从 6.3 提升到 7.4
2. 测试 2：
   - 胜率从 75％ 提升到 82％
   - SQN 从 10.2 提升到 10.9

结果也清楚表明：开盘强走势失败率很高。由于这些走势常伴随大 K 线，它们会被归类为突破信号，从而在我的研究中贡献了亏损交易。

因此第二条过滤基于时间：禁止在美东时间（EST）上午 10:10 之前入场。它带来的影响是：

1. 测试 1：
   - 胜率从 83％ 提升到 86％
   - SQN 从 7.4 提升到 8.9
2. 测试 2：
   - 胜率从 82％ 提升到 86％
   - SQN 从 10.9 提升到 13.9

---

## 小 R 盈利

多数小 R 盈利来自这样一种情形：价格行为背景并不支持进一步趋势，比如形态发生在通道第 3、4 段腿。

---

## 机会频率

在 5 分钟图上，平均每天约有 **5 个**形态。

---

## K 线大小的影响

当突破K线很大时，立即回调的概率显著更高：

- 在本报告撰写时点 \[8]，在平均波动条件（VIX 约 20％）下，ES 的“大 K 线”是 **20 点**或更高
- 交易这些大 K 线对系统总体表现影响不大，只贡献约 **2％**（也就是每赚 **10 万美元**，多赚约 **2000 美元**）
- 因此逻辑结论是：**忽略这些形态，是更好的选择**

---

## 对价格结构的贡献

- 有 **80％** 概率：反转枢轴点（reversal pivot）由形态第 1 根或其前一根形成（见图 17）
- 样本量小，但当反转枢轴点出现在形态第 1 根前 **2 根**时，多数交易会失败
- 换句话说：以“距离上一个波段点的 K 线数量”衡量，晚突破比早突破失败率高得多
- 有 **10％** 概率：形态第 1 根是内包K线，未参与形成反转枢轴点
  - 样本量小，但其中 **90％** 的形态获胜

![图 17：早形成 vs. 晚形成的反转枢轴点](/images/breakouts-whitepaper/figure-17.png)

---

## IBS 的影响

突破信号K线的 IBS：

- 当 IBS ≥ 75％：
  - 在分批加仓管理下，没有亏损的多头交易
  - 在简单管理下，有 **14％** 亏损
  - 一部分信号来自第 3、4 段腿
  - 强多头 IBS 形态占样本的 **27％**
- 当 IBS ≤ 25％：
  - 在分批加仓管理下，有 **6％** 的空头交易变成亏损
  - 在简单管理下，有 **33％** 形态亏损
  - 多数亏损来自第 3、4 段腿的晚信号
  - 强空头 IBS 形态占样本的 **48％**

---

# 反转 + 跟随 信号

## 为什么 Rev + FT 形态重要

### 1）它是一次“小意外”

Rev + FT 是反转信号的进化形态。整个研究数据集中共有 **1306** 根反转信号K线，其中 **430** 根得到了跟随 K 线，因此反转K线得到跟随的概率约 **33％**。

这个概率偏低，意味着它是一种“意外”。意外通常会有第二段腿。

### 2）它出现得足够频繁

虽然是意外，但 Rev + FT 的出现频率仍足够支撑统计意义上的信号有效性。

### 3）它足够“多用”

研究显示它也能用不止一种方式交易，因此具有通用性。它帮助交易者在不同背景中快速估算概率，并同步到市场意图。

---

## 立即跟随的概率

在形态第 2 根收盘后，立即出现跟随的概率是 **64％**。但同时：

1. 跟随到 1R 目标的概率只有 **20％**
2. 到 2R 的概率约 **9％**

当出现立即跟随时：

- 第二段腿小于第一段腿的概率只有 **20％**
- 更容易出现更深回调（PB ＞ 0.5R）

细节数据：

1. 多数立即跟随的走势不超过 **3 根**（平均 **2.5 根**）
2. 连续 **5 根**或以上的概率只有 **6％**；达到 **10 根**或以上的概率只有 **1％**
3. 立即跟随小于 **0.5R** 的概率 **＞ 40％**

---

## 同向第二段腿的概率

回调之后出现同向第二段腿的概率很高（接近 **90％**）：

- 第二段腿与第一段腿等大的概率：**70％**
- 第二段腿达到第一段腿 2 倍或更大的概率：**20％**

---

## 时间维度

按时间切片样本量偏小，但结果如下：

- **开盘（9:30～10:05 AM）**：没有亏损交易
- **10:10～11:55**：若能分批加仓，胜率 **＞ 90％**
- **12:00～13:55**：第 2 段及之后失败率更高；多数第 3、4 段腿形态失败
- **2:00～2:55 PM**：与 10:00～11:55 AM 类似，分批加仓下成功概率几乎相同
- **收盘**：无法对最后 40 分钟得出同样结论

---

## 微型缺口（MIG）

一个或多个 MIG 的存在，会显著影响概率：

1. 形态内出现 MIG（由第 2 根形成），且在第 1 或第 2 段腿：没有亏损交易
2. 形态之后出现 MIG（由跟随 K 线形成），且在第 1 或第 2 段腿：亏损概率约 **10％**，分批加仓可避免
3. 第 3、4 段腿的 MIG 有负面影响：样本量小，但暗示晚腿微型缺口会增强高潮性质，更容易走向高潮反转

---

## 先扫止损，再走第二段腿

1. 第二段腿前出现扫止损的概率：**26％**
2. 其中第 3、4 段腿形态失败比例：**80％**
   - 这意味着扫止损延续并演变成大反转
3. 第 1、2 段腿的扫止损，在分批加仓下可修复
4. 不论腿数，扫止损 ＜ 形态区间 **50％**：可修复
5. 不论腿数，扫止损 ＞ 形态区间 **50％**：最多只有 **15％** 概率可修复
   - 也就是说：如果扫止损越过波段点超过该腿区间的 50％，更可能是新突破，而不是扫止损

---

## 回调深度与持续时间

- **K 线数量**：平均 **3 根**，最多可到 **7～10 根**
- **回调深度**：
  1. 回调 ＞ 1R 的概率：**30％**
  2. 第 1、2 段腿里，深回调（≥ 1R）的回撤通常可通过分批加仓修复；晚腿里这些往往不是回调而是突破
  3. 0.75R 深回调出现 **40％**，也是盈亏平衡点或亏损最多的情形
     - 这种深度形态失败约 **45％**：建议快速退出或盈亏平衡点退出
     - 第 1、2 段腿更容易修复；第 3、4 段腿中，深回调交易失败 **＞ 90％**
  4. 回调小于 0.75R 的形态，亏损概率只有 **10％**，可通过分批加仓修复

---

## 交易生命周期 \[9]

形态完成后，市场平均用 **7 根 K 线**（5 分钟图约 **35 分钟**）回调并走出第二段 1R 腿。最长交易持续 **15 根**，也有很多 **10 根**左右的案例。

需要注意：每一次回调起初看起来都是反转或趋势方向上的失败突破，但当趋势恢复时，这个反转失败，就“回归为回调”。

---

## 跟随阶段出现微型缺口

当跟随产生 MIG，或形态内已有 MIG 时，深且持久的回调更少见。

---

## 立即跟随

出现跟随时，市场平均走 **3 根**左右、且小于 1R。完全不回调就到 1R 的概率只有 **16％**。

---

## R 倍数分布分析

两种测量方式：

1. 在第 2 根入场，持有到 1R：SQN 4.4
2. 在第 2 根入场，并在回调中加仓，目标 1R：SQN 9.2

这里的 1R，指第二段腿约等于第一段腿（见图示）。

研究目标仍是理解概率与细节影响。我是剥头皮者（Scalper）。剥头皮者更关心概率，而不是拿到很大的利润：他们愿意更频繁地做更小的利润，因为大多数交易会赢。

剔除第 3、4 段腿的形态会显著改善表现：胜率从 75％ 提升到 88％，SQN 为：

- 第 2 根入场，持有到 1R：SQN 6.9
- 第 2 根入场 + 回调加仓，目标 1R：SQN 12.2

最后，再剔除“深回调接近 90％或更深”的入场，几乎消除了剩余亏损，使胜率与 SQN 变为：

- 第 2 根入场，持有到 1R：SQN 9.8
- 第 2 根入场 + 回调加仓，目标 1R：SQN 14.9

---

## 小 R 盈利

多数小 R 盈利来自背景不支持持续趋势的情形，比如发生在通道第 3、4 段腿。

---

## 机会频率

在 5 分钟图上，平均每天约有 **8 个**形态。

---

## K 线大小影响：第 2 根 ≥ 第 1 根的 1R 区间

当第 2 根足够大，让早在第 1 根入场的人已经能拿到 1R：

- 若形态在第 1 或第 2 段腿：可交易的第二段腿概率上升；即便失败，分批加仓后盈亏平衡点退出概率更高
- 若形态在第 3 或第 4 段腿：通常是衰竭高潮，更适合做“押注失败（Fade）”

---

## 对价格结构的贡献

- 有 **80％** 概率：反转枢轴点由形态第 1 根或其前一根形成
- 样本量小，但当反转枢轴点出现在形态第 1 根前 **2 根**时，多数交易失败（见图 18）
- 有 **10％** 概率：第 1 根是内包K线，未参与形成反转枢轴点；样本量小，但其中 **90％** 获胜

![图 18：晚突破无法达到测量移动目标](/images/breakouts-whitepaper/figure-18.png)

---

## 形态 IBS 的影响

形态 IBS，指把两根形态合并成一根时的 IBS。

- 当形态 IBS ≥ 75％：除第 3、4 段腿外，没有亏损的多头交易；强 IBS 形态占样本 **60％**
- 当形态 IBS ≤ 25：除第 3、4 段腿外，没有亏损的空头交易；但这些晚腿里空头的失败率略低于多头；强 IBS 形态占样本 **34％**

---

# 外包K线信号

外包K线通常对应低时间级别的扩张三角形。交易外包K线很棘手，因为：

- 如果你买入一根强多头外包K线，本质上是在买低时间级别交易区间的顶部
- 这通常是价格容易停下并反转的位置

我的研究发现：把外包K线相对前一根的“向上突破距离”和“向下突破距离”量化出来并比较，可以提供关键信息：市场更可能找到买盘还是卖盘。

当外包K线上破前高的距离大于下破前低的距离时，外包K线低点下方通常有买盘，市场在那里找到支撑，有时足够做一笔快速的剥头皮多单。

图 19（右）展示了这种行为：第 7 根是空头反转外包K线，但它的高点大幅上破前一根高点。因此，尽管它是空头方向，它仍带有更强的偏多倾向；在其低点下方存在买盘。通常还会有另一条信息支持买入——此例中价格在均线之上，提示偏多市场状态。

相反，第 1 根下破第 81 根低点的距离更大；这种情况下，第 1 根高点上方通常有更多卖盘，而不是其低点下方的买盘。

![图 19：外包K线突破幅度大小](/images/breakouts-whitepaper/figure-19.png)

图 20 展示了 2022 年 9 月 27～28 日的 1.5 天交易。我的 PaintBar 指标（`AMA_Breakouts_PB`）识别外包K线，并按方向倾向分类，用不同颜色表示：我设置“偏多”为中蓝色，“偏空”为橙色。

![图 20：外包K线的方向倾向](/images/breakouts-whitepaper/figure-20.png)

进一步说，当像第 61 根（9 月 27 日）这样的 K 线，本应在上方出现更多卖盘，却因强多头突破而变成陷阱时，原本应作为阻力的高点，会“翻身”变成支撑。一小时后在第 73～74 根回测该价位时，会发现更多买盘：

- 被套的空头会回补空单以盈亏平衡点退出
- 看到空头被套的多头会用限价单买入
- 当没人愿意继续卖出时，价格自然在此找到支撑

如果你只看这张图，并按外包K线方向倾向去数剥头皮交易的结果，你会发现：9 月 28 日共有 **12 笔**交易，其中 **10 笔**盈利、**2 笔**盈亏平衡点退出，胜率 **83％**。这也与我更长周期回测的结果一致。

而基于失败信号的二次交易（比如 9 月 27 日的第 61 根，或 9 月 28 日的第 43、60 根）胜率更高。这类交易会套住按外包K线倾向入场的限价单交易者。二次交易的做法是：

- 等价格回测到“套人价位”
- 反向押注回测失败（Fade 测试）
  - 例如：在第 50 根买入回测第 43 根高点
  - 或在第 63 根买入回测第 60 根高点

这些二次交易胜率 **＞ 85％**。

---

# 高潮信号

高潮K线在 1～2 根内出现回调的概率是 **70％**；出现至少一个小第二段腿的概率 **＞ 60％**。下图展示了我的 PaintBar 识别并标出的高潮K线。更多逻辑可参考 PaintBar 技术指南。

![图 21：高潮K线](/images/breakouts-whitepaper/figure-21.png)

高潮K线是一种顺势突破。前文关于突破的讨论，同样适用于高潮K线。

---

# 给你的启发

我没有为最后两类信号（外包K线与高潮）写成“细到能照抄”的完整规则。原因是：大量研究显示，交易者交易“自己设计的系统”，通常比交易“别人设计的系统”更好。人各不同，性格与信念差异决定了你很难精确、稳定地交易别人的系统。

此外，这两类信号更依赖背景。我的做法始终是：

- 先看背景（Context）
- 再决定如何用外包K线（OB）与高潮（CX）做入场
- 以及入场后如何用它们辅助出场

举例说：

- 在一个楔形底（Wedge）这类底部结构里，买入一个外包K线买入信号，和
- 在交易区间顶部附近，被迫买入一根外包阳线

这两者完全不同。背景分析决定了你要不要买楔形底后的信号（不管它是不是外包K线信号），也决定了你是否应该忽略区间顶部附近的外包K线信号。

理解信号的概率，是设计盈利系统的关键因素之一。希望我分享的关键概念，以及胜率与概率数据，能让你愿意自己动手研究。它会帮助你建立交易研究能力，加速成长，最终成为一个能独立思考、靠技能吃饭的交易者。

---

# 进一步研究

这种风格的交易叫系统化交易，也可以理解为“设计即胜”。如果你喜欢，你可能会觉得 Quant System 的 Systems Academy Program 很有意思。这个项目我花了 3 年多开发，学生反馈非常好。你可以在这里了解更多：

`https://www.quantsystems.ca/sa-overview`

---

# 注释

\[1] 回看周期可以在 7～12 根之间。一个稳健系统不应因单一变量变化就崩溃；如果会崩溃，说明系统不稳健。我测试了不同回看周期，结果差异不大。

\[2] 在 Systems Academy Program 中，有两个完整章节专门讲如何为交易系统设计仓位规模与资金策略。我通常会在几个月周期内与学生一起完成这项任务。

\[3] T 分数是统计量，表示观测值距离均值的标准差数量。在系统化交易里，它用来衡量交易系统的可靠性，数值越高越好。

\[4] 标准差衡量数据相对均值的离散程度。这里的数据是 R（见下）。系统化交易者偏好更低的标准差，因为它会被用于计算 T 分数，并作为公式分母；标准差越小，T 分数越高，系统越可靠。

\[5] 平均 R 表示系统的平均盈利能力，以风险单位 R 表达。它描述了当系统交易足够久、结果具有统计显著性时，预期能得到的投资回报（以 R 表示）。

\[6] R 倍数（或 R）代表“风险（Risk）”。系统化交易者更喜欢用每笔交易的风险单位来计算盈亏，而不是用美元（或货币单位）。这样可以把系统表现与货币脱钩，便于跨品种、跨货币比较。这个概念由 Van K. Tharp 博士在其著作《*Trade Your Way to Financial Freedom*》（McGraw-Hill 出版）中推广。

\[7] 微型缺口：当两根不相邻 K 线之间没有重叠就形成微型缺口。例如在多头趋势中，若当前 K 线低点不等于两根之前的高点，那么两者之间存在微型缺口。因此，微型缺口需要 3 根 K 线才能形成。微型缺口是突破与趋势强度的信号之一，意味着动能存在。

\[8] 我在 2020 年写了这份研究报告的第一版修订。

\[9] 交易生命周期指：在某个形态/信号入场后，对后续跟随的总体预期。这些预期会因入场前的背景不同而差异很大。无论如何，每个形态通常都有强跟随、一般跟随、弱跟随三种情形。交易者需要逐一研究，熟悉不同市场条件下的生命周期，这能帮助你在跟随不符合预期时快速调整应对。
